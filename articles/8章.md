
## 8-1  web 安全攻击概述 


1. 为什么登陆的时候要求输入验证码
2. 网站长时间没有操作，session失效？


主要的漏洞分类（todo 

十大网络漏洞分类（略

## 8-2 验证机制安全

### 本章提炼总结： 验证机制是最外层，最基本的安全机制。



1.  验证机制是web应用程序中最简单的一种安全机制

		一般来说，应用程序必须核实用户提交的用户名和密码是否正确。  
		正确则允许登陆，否则禁止登陆。


2. 验证机制是应用程序防御恶意攻击的核心机制。
	
		处在安全防御的最前沿，如果被用户攻破，通常应用程序的全部功能、数据都会被其控制。
		
		缺乏安全有效的验证机制，其它核心安全机制都无法实施
		
		
		
3. 典型的身份验证模式讨论

		前端：用户登录  ——> 服务端：session生成  ——> 客户端：写入 cookie， 读取cookie 
		
		前端：读取cookie  ——> 服务端： 验证身份
	
	
	
4. 验证技术
	
		基于html 表单的验证
		多元验证，如组合型密码
		客户端ssl证书

5. 哪些不安全行为：
	
		由于密码的脆弱，暴力破解密码
		应对：
			验证码，扫码
			登陆尝试失败，次数限制 
		
	
	
6.	视频后面，略。。。  
	
		主要是讲，针对HTML表单验证的，安全措施
		
		
		
		
## 8-3 会话管理机制

session， 

可能针对 session的  攻击：


会话管理漏洞的防御：

1. 令牌传输安全

		令牌只能通过https传输
		如果使用 http cookie 传送令牌， 应将这些 cookie 标记为 secure，防止用户浏览器通过http 传送他们
	

2. 增加会话过期

		
		软会话过期，它指的是，用户在一定的时间内与应用系统没有交互，则会话过期，也就是我们常说的 session 失效
		
		硬会话过期，它指的是用户登录到系统中，经过一定的时间后，不管用户做什么，改会话都会过期。一般在银行系统中比较常用。
		
		


## 8-4 sql 注入攻击

几乎每一个web 应用都需要使用数据库保存用户输入。

sql注入原理：
	
	攻击者可以利用 sql注入，读取甚至修改数据库中保存的所有数据。
	
	用户可以提交一段 数据库查询代码，根据程序返回的结果，获得他想知道的信息。
	
	 
	 
在登陆账号中输入
	
	‘or’1=1
	
	此时查询数据变成，select  * from table  where name = 'zhangsan' ‘or’1=1  
	

危害：

	泄露数据，机密信息，账户信息等
	泄露数据库的具体结构，可能会进一步攻击
		
		

防御:
	
	参数化查询，是对sql 注入根本性的防御策略，预处理语句。
	对建立有个包含用户输入的sql 进行预处理。
	


## 8-5 xss 攻击


cross site scripting ，跨站脚本攻击，已经成为最流行的攻击方式。


允许web用户，将代码植入到 提供给其它用户使用的页面中，其它用户在观看网页时，恶意脚本就会执行。

通常通过注入html 或者  js脚本等发动攻击

攻击成功后，攻击者可以得到私密网页内容和 cookie 


	



案例：
	
	2005年，samy, 在用户资料页面，插入了js脚本
	
	如果某个用户查看了他的用户资料，这段脚本就会被执行
	
	一是把samy加为好友, 二是将上面的脚本复制到受害者自己资料页面中。
	
	
XSS分类
	
1. 反射式
		
2. 存储式
		脚本上传到web服务器上
3. 基于DOM式
			
		反射式xss攻击和存储式攻击，都是通过服务器提取用户提交的数据
		
		并且以不安全的方式将其返回给用户。
		
		基于 DOM 的攻击仅仅通过 JavaScript 的方式执行
		
		这种攻击经常发生在应用程序每次返回相同的静态html, 而通过客户端JavaScript动态生成信息，并不会跟服务端交互获取的时候。
			
			 
	
	



防御：

1. 输入验证，对用户输入进行验证
2. 


## 8-5 csrf攻击

cross site request forgery， 跨站请求伪造。

csrf 通过伪造来自受信任用户的请求来利用受信任的网站。

受害者做了他不知道做的事情。

总结：通过假装是 用户，做了一些事情。



 
 
 防御：
 	
 1. 增加确认操作
 		
 		如转账，弹出对话框，确定转账2000元么？ 
 
 2. 重新认证
 		
 		敏感操作时，要求用户重新输入密码进行二次验证，只有正确了才进行操作
 
 3. 增加 token 验证
 
 	用户刚登陆的时候，产生一个新的不可预知的 csrf token, 并且把 此 
 	token 存放在用户的 session 中
 	
 	在任何一个需要保护的表单中，增加一个隐藏字段来存放这个 token
 	
 	对于需要保护的url, 增加一个参数存放token
 	
 	提交请求时，在服务端检查提交的token 和 用户 session 中的 token 是否一致，如果一致，继续处理请求，否则返回一个错误信息给用户
 	
 	当用户退出，或者 session过期是，用户信息 ，包括CSRF token， 从 session 中移除并且销毁session
 	
 	
 	
 
 
 
 
 
 
 




